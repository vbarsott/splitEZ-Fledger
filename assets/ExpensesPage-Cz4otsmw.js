import{g as G,a as K,r as n,u as J,L as M,b as Q,c as X,j as a,s as Y,d as A,e as Z,f as _,h as ee,m as ae,l as N,i as R,A as te,k as se,n as ie,y as f,S as ne,C as oe,B as k,P as B,T as F,o as E,I as T,D as le}from"./index-DnTXmbWR.js";import{E as re,D as de,K as ce}from"./KeyboardDoubleArrowRight-DK0mE-NJ.js";import{F as L,I as O,S as z,T as $}from"./TextField-i7IHzZHH.js";const V=G("MuiListItemIcon",["root","alignItemsFlexStart"]);function ue(e){return K("MuiMenuItem",e)}const w=G("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),pe=(e,s)=>{const{ownerState:o}=e;return[s.root,o.dense&&s.dense,o.divider&&s.divider,!o.disableGutters&&s.gutters]},xe=e=>{const{disabled:s,dense:o,divider:d,disableGutters:h,selected:g,classes:u}=e,m=Z({root:["root",o&&"dense",s&&"disabled",!h&&"gutters",d&&"divider",g&&"selected"]},ue,u);return{...u,...m}},he=Y(_,{shouldForwardProp:e=>ee(e)||e==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:pe})(ae(({theme:e})=>({...e.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${w.selected}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${w.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}},[`&.${w.selected}:hover`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity)}},[`&.${w.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${w.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${R.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${R.inset}`]:{marginLeft:52},[`& .${N.root}`]:{marginTop:0,marginBottom:0},[`& .${N.inset}`]:{paddingLeft:36},[`& .${V.root}`]:{minWidth:36},variants:[{props:({ownerState:s})=>!s.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:s})=>s.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:s})=>!s.dense,style:{[e.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:s})=>s.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...e.typography.body2,[`& .${V.root} svg`]:{fontSize:"1.25rem"}}}]}))),q=n.forwardRef(function(s,o){const d=J({props:s,name:"MuiMenuItem"}),{autoFocus:h=!1,component:g="li",dense:u=!1,divider:W=!1,disableGutters:m=!1,focusVisibleClassName:p,role:b="menuitem",tabIndex:C,className:y,...I}=d,v=n.useContext(M),P=n.useMemo(()=>({dense:u||v.dense||!1,disableGutters:m}),[v.dense,u,m]),l=n.useRef(null);Q(()=>{h&&l.current&&l.current.focus()},[h]);const x={...d,dense:P.dense,divider:W,disableGutters:m},j=xe(d),D=X(l,o);let S;return d.disabled||(S=C!==void 0?C:-1),a.jsx(M.Provider,{value:P,children:a.jsx(he,{ref:D,role:b,tabIndex:S,component:g,focusVisibleClassName:A(j.focusVisible,p),className:A(j.root,y),...I,ownerState:x,classes:j})})}),ve=()=>{const{groups:e,expenses:s,setExpenses:o,addExpense:d,deleteExpense:h,updateExpense:g}=n.useContext(te),u=se(),W=ie(),[m,p]=n.useState(!1),[b,C]=n.useState(""),[y,I]=n.useState(""),[v,P]=n.useState(""),[l,x]=n.useState({id:null,whoPaid:"",paidWhat:"",amountPaid:""}),j=n.useCallback(async t=>{t.preventDefault(),p(!0);const c={amountPaid:Number(b),whoPaid:y,paidWhat:v};try{const i=await d(c);o(r=>[...r,i]),f.success("Expense added!")}catch(i){console.error("Error adding expense:",i),f.error("Failed to add expense.")}finally{p(!1),I(""),P(""),C("")}},[b,y,v,d,o]),D=n.useCallback(t=>{x({id:t.id,whoPaid:t.whoPaid,paidWhat:t.paidWhat,amountPaid:t.amountPaid})},[]),S=n.useCallback(async t=>{p(!0);try{await h(t),o(c=>c.filter(i=>i.id!==t)),f.success("Expense deleted successfully!")}catch(c){console.error("Error deleting expense:",c),f.error("Failed to delete expense.")}finally{p(!1)}},[h,o]),H=n.useCallback(async()=>{try{p(!0);const t={whoPaid:l.whoPaid,paidWhat:l.paidWhat,amountPaid:l.amountPaid},c=await g(l.id,t);o(i=>i.map(r=>r.id===l.id?c:r)),f.success("Changes saved successfully!")}catch(t){console.error("Error saving changes:",t),f.error("Failed to save changes.")}finally{p(!1),x({id:null,whoPaid:"",paidWhat:"",amountPaid:""})}},[l,g,o]),U=()=>{x({id:null,whoPaid:"",paidWhat:"",amountPaid:""}),f.info("Edit cancelled.")};return m?a.jsx(ne,{loading:!0}):a.jsx(a.Fragment,{children:a.jsx(oe,{maxWidth:"sm",children:a.jsxs(k,{sx:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",flexWrap:"wrap",gap:4,textAlign:"center"},children:[a.jsxs(B,{component:"form",onSubmit:j,elevation:3,sx:{display:"flex",flexDirection:"column",gap:2,maxWidth:500,width:"100%",p:4},children:[a.jsx(F,{variant:"h5",sx:{textAlign:"center"},children:"Step 2: Add the expenses"}),a.jsxs(L,{fullWidth:!0,required:!0,children:[a.jsx(O,{id:"whoPaid-label",children:"Who"}),a.jsx(z,{labelId:"whoPaid-label","aria-labelledby":"whoPaid-label",id:"whoPaid",name:"whoPaid",value:y,onChange:t=>I(t.target.value),label:"Who",children:e.map(t=>a.jsx(q,{value:t.groupName,children:t.groupName},t.id))})]}),a.jsx($,{id:"paidWhat",name:"paidWhat",type:"text",label:"What",autoComplete:"off",value:v,onChange:t=>P(t.target.value),variant:"outlined",fullWidth:!0,required:!0}),a.jsx($,{id:"amountPaid",name:"amountPaid",type:"text",label:"How Much CA$",placeholder:"CA$",autoComplete:"off",value:b,onChange:t=>C(Number(t.target.value)),variant:"outlined",fullWidth:!0,required:!0}),a.jsx(E,{type:"submit",variant:"contained",fullWidth:!0,children:"Add Expense"})]}),a.jsxs(B,{elevation:3,sx:{display:"flex",flexDirection:"column",gap:2,maxWidth:500,width:"100%",p:4},children:[a.jsx(F,{variant:"h5",sx:{textAlign:"center"},children:"Expenses:"}),s.map((t,c)=>a.jsxs(n.Fragment,{children:[a.jsxs(k,{sx:{display:"flex",justifyContent:"space-between",gap:1,alignItems:"center",py:1},children:[l.id===t.id?a.jsxs(a.Fragment,{children:[a.jsxs(L,{fullWidth:!0,required:!0,children:[a.jsx(O,{id:"whoPaid-label-edit",children:"Who"}),a.jsx(z,{labelId:"whoPaid-label-edit","aria-labelledby":"whoPaid-label-edit",id:"editedWhoPaid",name:"editedWhoPaid",value:l.whoPaid,onChange:i=>x(r=>({...r,whoPaid:i.target.value})),label:"Who",children:e.map(i=>a.jsx(q,{value:i.groupName,children:i.groupName},i.id))})]}),a.jsx($,{value:l.paidWhat,onChange:i=>x(r=>({...r,paidWhat:i.target.value})),variant:"outlined",fullWidth:!0}),a.jsx($,{type:"number",value:l.amountPaid,onChange:i=>x(r=>({...r,amountPaid:Number(i.target.value)})),variant:"outlined",fullWidth:!0}),a.jsx(E,{variant:"contained",onClick:H,children:"Save"}),a.jsx(E,{variant:"contained",onClick:U,children:"Cancel"})]}):a.jsxs(F,{sx:{textAlign:"left",fontWeight:"bold",fontSize:"1.2rem"},children:[t.whoPaid," paid CA$",t.amountPaid," for"," ",t.paidWhat]}),a.jsxs(k,{sx:{display:"flex",justifyContent:"space-between",gap:1,alignItems:"center"},children:[a.jsx(T,{onClick:()=>D(t),"aria-label":"Edit expense",children:a.jsx(re,{sx:{fontSize:30,color:u.palette.text.icon}})}),a.jsx(T,{onClick:()=>S(t.id),"aria-label":"Delete expense",children:a.jsx(de,{sx:{fontSize:30,color:u.palette.text.icon}})})]})]}),c<s.length-1&&a.jsx(le,{})]},t.id))]}),a.jsx(k,{sx:{width:"100%",maxWidth:500,mb:4},children:a.jsxs(E,{variant:"contained",fullWidth:!0,onClick:()=>W("/result"),children:["Check the Result",a.jsx(ce,{sx:{ml:1,fontSize:30}})]})})]})})})};export{ve as default};

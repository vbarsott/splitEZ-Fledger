import{r as n,A as F,k as I,n as O,y as o,j as e,S as T,C as z,B as d,P as k,T as f,o as p,I as D,D as B}from"./index-CHwEwIFo.js";import{E as q,D as K,K as R}from"./KeyboardDoubleArrowRight-IMTS6aWd.js";import{T as x}from"./TextField-D9bUeY1g.js";const M=()=>{const{groups:g,setGroups:i,addGroup:j,deleteGroup:b,updateGroup:v}=n.useContext(F),C=I(),G=O(),[E,c]=n.useState(!1),[m,y]=n.useState(""),[h,S]=n.useState(""),[l,u]=n.useState({id:null,name:"",count:""}),N=n.useCallback(async t=>{t.preventDefault(),c(!0);const r={groupName:m,numberOfPeople:Number(h)};try{const a=await j(r);i(s=>[...s,a]),o.success("Group added!")}catch(a){console.error("Error adding group:",a),o.error("Failed to add group.")}finally{c(!1),y(""),S("")}},[m,h,j,i]),W=n.useCallback(t=>{u({id:t.id,name:t.groupName,count:t.numberOfPeople})},[]),w=n.useCallback(async t=>{c(!0);try{await b(t),i(r=>r.filter(a=>a.id!==t)),o.success("Group deleted successfully!")}catch(r){console.error("Error deleting group:",r),o.error("Failed to delete group.")}finally{c(!1)}},[b,i]),P=n.useCallback(async()=>{try{c(!0);const t={groupName:l.name,numberOfPeople:l.count},r=await v(l.id,t);i(a=>a.map(s=>s.id===l.id?r:s)),o.success("Changes saved successfully!")}catch(t){console.error("Error saving changes:",t),o.error("Failed to save changes.")}finally{c(!1),u({id:null,name:"",count:""})}},[l,v,i]),A=()=>{u({id:null,name:"",count:""}),o.info("Edit cancelled.")};return E?e.jsx(T,{loading:!0}):e.jsx(e.Fragment,{children:e.jsx(z,{maxWidth:"sm",children:e.jsxs(d,{sx:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",flexWrap:"wrap",gap:4,textAlign:"center"},children:[e.jsxs(k,{component:"form",onSubmit:N,elevation:3,sx:{display:"flex",flexDirection:"column",gap:2,maxWidth:500,width:"100%",p:4},children:[e.jsx(f,{variant:"h5",sx:{textAlign:"center"},children:"Step 1: Create a group"}),e.jsxs(d,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(x,{type:"text",label:"Group name",name:"groupName",autoComplete:"off",value:m,onChange:t=>y(t.target.value),variant:"outlined",fullWidth:!0,required:!0}),e.jsx(x,{type:"number",label:"Number of people",name:"numberOfPeople",autoComplete:"number-of-people",value:h,onChange:t=>S(Number(t.target.value)),variant:"outlined",fullWidth:!0,required:!0}),e.jsx(p,{type:"submit",variant:"contained",fullWidth:!0,children:"Add Group"})]})]}),e.jsxs(k,{elevation:3,sx:{display:"flex",flexDirection:"column",gap:2,maxWidth:500,width:"100%",p:4},children:[e.jsx(f,{variant:"h5",sx:{textAlign:"center"},children:"Groups:"}),g.map((t,r)=>e.jsxs(n.Fragment,{children:[e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:1,py:1},children:[l.id===t.id?e.jsxs(e.Fragment,{children:[e.jsx(x,{value:l.name,onChange:a=>u(s=>({...s,name:a.target.value})),variant:"outlined",fullWidth:!0}),e.jsx(x,{type:"number",value:l.count,onChange:a=>u(s=>({...s,count:Number(a.target.value)})),variant:"outlined",fullWidth:!0}),e.jsx(p,{variant:"contained",onClick:P,children:"Save"}),e.jsx(p,{variant:"contained",onClick:A,children:"Cancel"})]}):e.jsxs(f,{sx:{textAlign:"left",fontWeight:"bold",fontSize:"1.2rem"},children:[t.groupName," (",t.numberOfPeople," people)"]}),e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",gap:1,alignItems:"center"},children:[e.jsx(D,{onClick:()=>W(t),"aria-label":"Edit group",children:e.jsx(q,{sx:{fontSize:30,color:C.palette.text.icon}})}),e.jsx(D,{onClick:()=>w(t.id),"aria-label":"Delete group",children:e.jsx(K,{sx:{fontSize:30,color:C.palette.text.icon}})})]})]}),r<g.length-1&&e.jsx(B,{})]},t.id))]}),e.jsx(d,{sx:{width:"100%",maxWidth:500,mb:4},children:e.jsxs(p,{variant:"contained",fullWidth:!0,onClick:()=>G("/expenses"),children:["Add the Expenses",e.jsx(R,{sx:{ml:1,fontSize:30}})]})})]})})})};export{M as default};
